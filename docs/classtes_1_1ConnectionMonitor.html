<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3es: tes::ConnectionMonitor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">3es
   &#160;<span id="projectnumber">0.7</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classtes_1_1ConnectionMonitor.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classtes_1_1ConnectionMonitor-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">tes::ConnectionMonitor Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>A utility class for monitoring new connections for a <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code>.  
 <a href="classtes_1_1ConnectionMonitor.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="3esconnectionmonitor_8h_source.html">3esconnectionmonitor.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a5bf73a155757586127025ec4fc8081ff"><td class="memItemLeft" align="right" valign="top"><a id="a5bf73a155757586127025ec4fc8081ff"></a>enum &#160;</td><td class="memItemRight" valign="bottom"><b>Mode</b> { <b>None</b>, 
<b>Synchronous</b>, 
<b>Asynchronous</b>
 }</td></tr>
<tr class="separator:a5bf73a155757586127025ec4fc8081ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a114a20ff82fd77e7da537ea98f27d6d7"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a114a20ff82fd77e7da537ea98f27d6d7">start</a> (Mode <a class="el" href="classtes_1_1ConnectionMonitor.html#a56339ea45545a33bbc0e1289b3503519">mode</a>)=0</td></tr>
<tr class="memdesc:a114a20ff82fd77e7da537ea98f27d6d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the monitor listening in the specified mode.  <a href="#a114a20ff82fd77e7da537ea98f27d6d7">More...</a><br /></td></tr>
<tr class="separator:a114a20ff82fd77e7da537ea98f27d6d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55c032ddcac6b1ce37fae665fabfee07"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a55c032ddcac6b1ce37fae665fabfee07">stop</a> ()=0</td></tr>
<tr class="memdesc:a55c032ddcac6b1ce37fae665fabfee07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stops listening for further connections.  <a href="#a55c032ddcac6b1ce37fae665fabfee07">More...</a><br /></td></tr>
<tr class="separator:a55c032ddcac6b1ce37fae665fabfee07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b417c725275985acc9b6933bd30992"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#ab5b417c725275985acc9b6933bd30992">join</a> ()=0</td></tr>
<tr class="memdesc:ab5b417c725275985acc9b6933bd30992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Called to join the monitor thread.  <a href="#ab5b417c725275985acc9b6933bd30992">More...</a><br /></td></tr>
<tr class="separator:ab5b417c725275985acc9b6933bd30992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12188c156141e2509e3be3eed9402d2"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#af12188c156141e2509e3be3eed9402d2">isRunning</a> () const =0</td></tr>
<tr class="memdesc:af12188c156141e2509e3be3eed9402d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the connection monitor has start.  <a href="#af12188c156141e2509e3be3eed9402d2">More...</a><br /></td></tr>
<tr class="separator:af12188c156141e2509e3be3eed9402d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56339ea45545a33bbc0e1289b3503519"><td class="memItemLeft" align="right" valign="top">virtual Mode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a56339ea45545a33bbc0e1289b3503519">mode</a> () const =0</td></tr>
<tr class="memdesc:a56339ea45545a33bbc0e1289b3503519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the current running mode.  <a href="#a56339ea45545a33bbc0e1289b3503519">More...</a><br /></td></tr>
<tr class="separator:a56339ea45545a33bbc0e1289b3503519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6024a174700e90daa3ec24e324ae6c88"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a6024a174700e90daa3ec24e324ae6c88">waitForConnection</a> (unsigned timeoutMs)=0</td></tr>
<tr class="memdesc:a6024a174700e90daa3ec24e324ae6c88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait up to <code>timeoutMs</code> milliseconds for a connection.  <a href="#a6024a174700e90daa3ec24e324ae6c88">More...</a><br /></td></tr>
<tr class="separator:a6024a174700e90daa3ec24e324ae6c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad615c2fd38e0f78ec72f0b1fc67da6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a2ad615c2fd38e0f78ec72f0b1fc67da6">monitorConnections</a> ()=0</td></tr>
<tr class="memdesc:a2ad615c2fd38e0f78ec72f0b1fc67da6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accepts new connections and checks for expired connections, but effects neither in the <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code>.  <a href="#a2ad615c2fd38e0f78ec72f0b1fc67da6">More...</a><br /></td></tr>
<tr class="separator:a2ad615c2fd38e0f78ec72f0b1fc67da6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f90cafd07d22f404d324cbf2ac37c9e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a6f90cafd07d22f404d324cbf2ac37c9e">setConnectionCallback</a> (void(*callback)(<a class="el" href="classtes_1_1Server.html">Server</a> &amp;, <a class="el" href="classtes_1_1Connection.html">Connection</a> &amp;, void *), void *user)=0</td></tr>
<tr class="memdesc:a6f90cafd07d22f404d324cbf2ac37c9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the callback invoked for each new connection.  <a href="#a6f90cafd07d22f404d324cbf2ac37c9e">More...</a><br /></td></tr>
<tr class="separator:a6f90cafd07d22f404d324cbf2ac37c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad59be7d4f38eb75e23ebb026793e1391"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#ad59be7d4f38eb75e23ebb026793e1391">setConnectionCallback</a> (const std::function&lt; void(<a class="el" href="classtes_1_1Server.html">Server</a> &amp;, <a class="el" href="classtes_1_1Connection.html">Connection</a> &amp;)&gt; &amp;callback)=0</td></tr>
<tr class="memdesc:ad59be7d4f38eb75e23ebb026793e1391"><td class="mdescLeft">&#160;</td><td class="mdescRight">An overload of <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a6f90cafd07d22f404d324cbf2ac37c9e" title="Sets the callback invoked for each new connection. ">setConnectionCallback()</a></code> using the C++11 <code>funtion</code> object.  <a href="#ad59be7d4f38eb75e23ebb026793e1391">More...</a><br /></td></tr>
<tr class="separator:ad59be7d4f38eb75e23ebb026793e1391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2a02e77a49ece1d183830d17e8c0941"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#aa2a02e77a49ece1d183830d17e8c0941">commitConnections</a> ()=0</td></tr>
<tr class="memdesc:aa2a02e77a49ece1d183830d17e8c0941"><td class="mdescLeft">&#160;</td><td class="mdescRight">Migrates new connections to the owning <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code> and removes expired connections.  <a href="#aa2a02e77a49ece1d183830d17e8c0941">More...</a><br /></td></tr>
<tr class="separator:aa2a02e77a49ece1d183830d17e8c0941"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a3aac9d9446d130c6409624dd431e1e98"><td class="memItemLeft" align="right" valign="top"><a id="a3aac9d9446d130c6409624dd431e1e98"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtes_1_1ConnectionMonitor.html#a3aac9d9446d130c6409624dd431e1e98">~ConnectionMonitor</a> ()</td></tr>
<tr class="memdesc:a3aac9d9446d130c6409624dd431e1e98"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protected virtual destructor. <br /></td></tr>
<tr class="separator:a3aac9d9446d130c6409624dd431e1e98"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A utility class for monitoring new connections for a <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code>. </p>
<p>The monitor manages listening for new connections and expiring old ones. Doing so can be time consuming, so the monitor supports running its own monitor thread. It also supports synchronous operation in case connection monitoring is unnecessary, or unable to be pushed off thread.</p>
<p>Asynchronous mode is activated by calling <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a114a20ff82fd77e7da537ea98f27d6d7" title="Starts the monitor listening in the specified mode. ">start()</a></code> and stopped with <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a55c032ddcac6b1ce37fae665fabfee07" title="Stops listening for further connections. ">stop()</a></code>. Calls to <code><a class="el" href="classtes_1_1ConnectionMonitor.html#ab5b417c725275985acc9b6933bd30992" title="Called to join the monitor thread. ">join()</a></code> will block until the monitor thread has completed, but should only be called after <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a55c032ddcac6b1ce37fae665fabfee07" title="Stops listening for further connections. ">stop()</a></code> has been called. The <code><a class="el" href="classtes_1_1ConnectionMonitor.html#aa2a02e77a49ece1d183830d17e8c0941" title="Migrates new connections to the owning Server and removes expired connections. ">commitConnections()</a></code> method must still be called by the main thread (synchronously) to control when connections are activated and deactivated.</p>
<p>Synchronous mode is supported by calling <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a2ad615c2fd38e0f78ec72f0b1fc67da6" title="Accepts new connections and checks for expired connections, but effects neither in the Server...">monitorConnections()</a></code> to accept new connections. This must be followed by a call to <code><a class="el" href="classtes_1_1ConnectionMonitor.html#aa2a02e77a49ece1d183830d17e8c0941" title="Migrates new connections to the owning Server and removes expired connections. ">commitConnections()</a></code> to commit the changes to the owning <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code>.</p>
<dl class="section user"><dt>Synchronous Usage</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">float</span> dt = 0;</div><div class="line">Server *server = <a class="code" href="classtes_1_1Server.html#ab1ed5e91f6470eb930f07713d8d37012">Server::create</a>()</div><div class="line">server-&gt;connectionMonitor()-&gt;<a class="code" href="classtes_1_1ConnectionMonitor.html#a114a20ff82fd77e7da537ea98f27d6d7">start</a>(<a class="code" href="namespacetes.html">tes</a>::ConnectionMonitor::Synchronous);</div><div class="line">for (;;)</div><div class="line">{</div><div class="line">  <span class="comment">// Prepare frame.</span></div><div class="line">  <span class="comment">//...</span></div><div class="line"></div><div class="line">  server-&gt;updateFrame(dt);</div><div class="line">  server-&gt;connectionMonitor()-&gt;monitorConnections();</div><div class="line">  server-&gt;connectionMonitor()-&gt;commitConnections();</div><div class="line"></div><div class="line">  <span class="comment">// Loop end...</span></div><div class="line">}</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Asynchronous Usage</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">float</span> dt = 0;</div><div class="line">Server *server = <a class="code" href="classtes_1_1Server.html#ab1ed5e91f6470eb930f07713d8d37012">Server::create</a>()</div><div class="line">server-&gt;connectionMonitor()-&gt;<a class="code" href="classtes_1_1ConnectionMonitor.html#a114a20ff82fd77e7da537ea98f27d6d7">start</a>(<a class="code" href="namespacetes.html">tes</a>::ConnectionMonitor::Asynchronous);</div><div class="line">for (;;)</div><div class="line">{</div><div class="line">  <span class="comment">// Prepare frame.</span></div><div class="line">  <span class="comment">//...</span></div><div class="line"></div><div class="line">  server-&gt;updateFrame(dt);</div><div class="line">  server-&gt;connectionMonitor()-&gt;commitConnections();</div><div class="line"></div><div class="line">  <span class="comment">// Loop end...</span></div><div class="line">}</div><div class="line"></div><div class="line">server-&gt;connectionMonitor()-&gt;stop();  <span class="comment">// Safe even if Synchronous</span></div><div class="line">server-&gt;connectionMonitor()-&gt;join();  <span class="comment">// Safe even if Synchronous</span></div></div><!-- fragment --> </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa2a02e77a49ece1d183830d17e8c0941"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2a02e77a49ece1d183830d17e8c0941">&#9670;&nbsp;</a></span>commitConnections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::commitConnections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Migrates new connections to the owning <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code> and removes expired connections. </p>
<p>For each new connection, the callback set in <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a6f90cafd07d22f404d324cbf2ac37c9e" title="Sets the callback invoked for each new connection. ">setConnectionCallback()</a></code> is invoked, passing the server, connection and <code>user</code> argument.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>When given, called for each new connection. </td></tr>
    <tr><td class="paramname">user</td><td>User argument passed to <code>callback</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="af12188c156141e2509e3be3eed9402d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12188c156141e2509e3be3eed9402d2">&#9670;&nbsp;</a></span>isRunning()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool tes::ConnectionMonitor::isRunning </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the connection monitor has start. </p>
<dl class="section return"><dt>Returns</dt><dd>True if running. </dd></dl>

</div>
</div>
<a id="ab5b417c725275985acc9b6933bd30992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b417c725275985acc9b6933bd30992">&#9670;&nbsp;</a></span>join()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::join </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Called to join the monitor thread. </p>
<p>Returns immediately if not running. </p>

</div>
</div>
<a id="a56339ea45545a33bbc0e1289b3503519"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56339ea45545a33bbc0e1289b3503519">&#9670;&nbsp;</a></span>mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual Mode tes::ConnectionMonitor::mode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the current running mode. </p>
<p><code>Asynchronous</code> mode is set as soon as <code>start(Asynchronous)</code> is called and drops to <code>None</code> after calling <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a55c032ddcac6b1ce37fae665fabfee07" title="Stops listening for further connections. ">stop()</a></code> once the thread has stopped.</p>
<p><code>Synchronous</code> mode is set as soon as <code>start(Synchronous)</code> is called and drops to <code>None</code> on calling <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a55c032ddcac6b1ce37fae665fabfee07" title="Stops listening for further connections. ">stop()</a></code>.</p>
<p>The mode is <code>None</code> if not running in either mode. </p>

</div>
</div>
<a id="a2ad615c2fd38e0f78ec72f0b1fc67da6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ad615c2fd38e0f78ec72f0b1fc67da6">&#9670;&nbsp;</a></span>monitorConnections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::monitorConnections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Accepts new connections and checks for expired connections, but effects neither in the <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code>. </p>
<p>This is either called on the main thread for synchronous operation, or internally in asynchronous mode. </p>

</div>
</div>
<a id="a6f90cafd07d22f404d324cbf2ac37c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f90cafd07d22f404d324cbf2ac37c9e">&#9670;&nbsp;</a></span>setConnectionCallback() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::setConnectionCallback </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="classtes_1_1Server.html">Server</a> &amp;, <a class="el" href="classtes_1_1Connection.html">Connection</a> &amp;, void *)&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the callback invoked for each new connection. </p>
<p>This is invoked from <code><a class="el" href="classtes_1_1ConnectionMonitor.html#aa2a02e77a49ece1d183830d17e8c0941" title="Migrates new connections to the owning Server and removes expired connections. ">commitConnections()</a></code> for each new connection. The arguments passed to the callback are:</p><ul>
<li><code>server</code> : the <code><a class="el" href="classtes_1_1Server.html" title="Defines the interface for managing a 3es server. ">Server</a></code> object.</li>
<li><code>connection</code> : the new <code><a class="el" href="classtes_1_1Connection.html" title="Defines the interfaces for a client connection. ">Connection</a></code> object.</li>
<li><code>user</code> : the <code>user</code> argument given here.</li>
</ul>
<p>Write only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The callback function pointer. </td></tr>
    <tr><td class="paramname">user</td><td>A user pointer passed to the <code>callback</code> whenever it is invoked. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad59be7d4f38eb75e23ebb026793e1391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad59be7d4f38eb75e23ebb026793e1391">&#9670;&nbsp;</a></span>setConnectionCallback() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::setConnectionCallback </td>
          <td>(</td>
          <td class="paramtype">const std::function&lt; void(<a class="el" href="classtes_1_1Server.html">Server</a> &amp;, <a class="el" href="classtes_1_1Connection.html">Connection</a> &amp;)&gt; &amp;&#160;</td>
          <td class="paramname"><em>callback</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>An overload of <code><a class="el" href="classtes_1_1ConnectionMonitor.html#a6f90cafd07d22f404d324cbf2ac37c9e" title="Sets the callback invoked for each new connection. ">setConnectionCallback()</a></code> using the C++11 <code>funtion</code> object. </p>
<p>Both methods are provided to cater for potential ABI issues.</p>
<p>No user argument is supported as the flexibility of <code>std::function</code> obviates the for such.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">callback</td><td>The function to invoke for each new connection. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a114a20ff82fd77e7da537ea98f27d6d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a114a20ff82fd77e7da537ea98f27d6d7">&#9670;&nbsp;</a></span>start()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool tes::ConnectionMonitor::start </td>
          <td>(</td>
          <td class="paramtype">Mode&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Starts the monitor listening in the specified mode. </p>
<p>The listening thread is started if <code>mode</code> is <code>Asynchronous</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>The listening mode. Mode <code>Node</code> is ignored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if listening is running in the specified <code>mode</code>. This includes both newly started and if it was already running in that mode. False is returned if <code>mode</code> is <code>None</code>, or differs from the running mode. </dd></dl>

</div>
</div>
<a id="a55c032ddcac6b1ce37fae665fabfee07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55c032ddcac6b1ce37fae665fabfee07">&#9670;&nbsp;</a></span>stop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void tes::ConnectionMonitor::stop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stops listening for further connections. </p>
<p>This requests termination of the monitor thread if running.</p>
<p>Safe to call if not running. </p>

</div>
</div>
<a id="a6024a174700e90daa3ec24e324ae6c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6024a174700e90daa3ec24e324ae6c88">&#9670;&nbsp;</a></span>waitForConnection()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual int tes::ConnectionMonitor::waitForConnection </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>timeoutMs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wait up to <code>timeoutMs</code> milliseconds for a connection. </p>
<p>Returns immediately if we already have a connection. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">timeoutMs</td><td>The time out to wait in milliseconds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of connections on returning. These may need to be committed. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="3esconnectionmonitor_8h_source.html">3esconnectionmonitor.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacetes.html">tes</a></li><li class="navelem"><a class="el" href="classtes_1_1ConnectionMonitor.html">ConnectionMonitor</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
